{% extends 'base.html.twig' %}

{% block title %}SymfonyReseau{% endblock %}

{% block body %}
    <div class="container">
        <h1>Créer un retard</h1>
        <form action="{{ path('app_create_post') }}" method="post">
            <div class="form-group">
                <label for="titre">Titre :</label>
                <input type="text" id="titre" name="titre" class="form-control">
            </div>
            <div class="form-group">
                <label for="description">Description :</label>
                <textarea id="description" name="description" class="form-control"></textarea>
                <label for="#">Choisir un #</label>
                <textarea id="#" name="#" class="form-control"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Créer</button>
        </form>

        <br>
        <br>
        <h1>Publications</h1>
        {% if publications %}
            <ul class="list-group">
                {% for publication in publications %}
                    <li class="list-group-item">
                        <h4>{{ publication.titre }}</h4>
                        <p>{{ publication.description }}</p>
                        <a href="{{ path('app_modify_post', {'id': publication.id}) }}" class="btn btn-primary">Modifier</a>
                        <button type="button" class="btn btn-success like-btn" data-post-id="{{ publication.id }}">
                            <i class="fas fa-thumbs-up"></i> Like <span class="like-count">0</span>
                        </button>
                        <button type="button" class="btn btn-warning super-like-btn" data-post-id="{{ publication.id }}">
                            <i class="fas fa-star"></i> Super Like <span class="super-like-count">0</span>
                        </button>
                        <button type="button" class="btn btn-info comment-btn" onclick="redirectToCommentPage({{ publication.id }})">Commentaire</button>
                        <label for="commentaire">Commentaire :</label>
                        <textarea id="commentaire" name="commentaire" class="form-control">

</textarea>

                        </textarea>


                        <script>
                            function redirectToCommentPage(postId) {
                                window.location.href = "{{ path('app_add_comment', {'id': '__postId__'}) }}".replace('__postId__', postId);
                            }
                        </script>
                    </li>
                {% endfor %}

            </ul>
        {% else %}
            <p class="lead">Aucune publication disponible.</p>
        {% endif %}
    </div>

    <!-- Inclure la bibliothèque Font Awesome -->
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const likeButtons = document.querySelectorAll('.like-btn');
            const superLikeButtons = document.querySelectorAll('.super-like-btn');
            const commentButtons = document.querySelectorAll('.comment-btn');

            likeButtons.forEach(function(button) {
                button.addEventListener('click', function(event) {
                    const postId = this.getAttribute('data-post-id');
                    // Augmenter le compteur de likes et mettre à jour le texte du bouton
                    const likeCountElement = this.querySelector('.like-count');
                    likeCountElement.textContent = parseInt(likeCountElement.textContent) + 1;
                });
            });

            superLikeButtons.forEach(function(button) {
                button.addEventListener('click', function(event) {
                    const postId = this.getAttribute('data-post-id');
                    // Augmenter le compteur de super likes et mettre à jour le texte du bouton
                    const superLikeCountElement = this.querySelector('.super-like-count');
                    superLikeCountElement.textContent = parseInt(superLikeCountElement.textContent) + 1;
                });
            });

            commentButtons.forEach(function(button) {
                button.addEventListener('click', function(event) {
                    const postId = this.getAttribute('data-post-id');
                    // Rediriger l'utilisateur vers la page de commentaire ou afficher un formulaire de commentaire
                    console.log('Commented on post with ID:', postId);
                });
            });
        });
    </script>
{% endblock %}
